<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css" />
    <title>index</title>
  </head>
  <body>
    <h1>Hello, World!</h1>
    <div>
      <textarea
        id="memoTitle"
        class="title"
        maxlength="100"
        placeholder="title"
      ></textarea>
      <textarea
        id="memoContents"
        class="content"
        maxlength="1000"
        placeholder="memo"
      ></textarea>
      <textarea id="memoTag" class="tag" placeholder="tag"></textarea>
      <button type="button" onclick="saveMemo()">Save</button>
      <ul id="memoList"></ul>
    </div>
  </body>
  <script>
    let key = 1;

    window.onload = function () {
      localStorage.clear();
    };

    const clearText = () => {
      document.getElementById("memoTitle").value = "";
      document.getElementById("memoContents").value = "";
    };

    function saveMemo() {
      const memo = {
        title: document.getElementById("memoTitle").value,
        contents: document.getElementById("memoContents").value,
      };

      if (memo.title && memo.contents) {
        if (memo.title.length <= 100 && memo.contents.length <= 1000) {
          const jsonString = JSON.stringify(memo);
          localStorage.setItem(key, jsonString);
          appendMemo();
          key++;
          clearText();
        }
      }
    }

    function appendMemo() {
      const memo = readMemo();

      const ul = document.getElementById("memoList");
      const li = document.createElement("li");
      const text = document.createTextNode(memo);
      li.appendChild(text);
      ul.appendChild(li);
    }

    function readMemo() {
      const memo = JSON.parse(localStorage.getItem(`${key}`));
      const text = "title: " + memo.title + " contents: " + memo.contents;
      console.log(text);
      return text;
      //console.log("title: %s contents: %s", memo.title, memo.contents);
    }
  </script>
</html>
